---
title: "KaggleXChallenge"
author: "Arindam Baruah"
format: html
---

```{r}
library(tidyverse)
```

```{r}
df_train <- read_csv("data/train.csv")
df_test <- read_csv("data/test.csv")
```
```{r}
ggplot(data = df_train,aes(y = as.factor(model_year),x = price)) + geom_boxplot()
```

```{r}
ggplot(data = df_train,aes(y = milage,x = price)) + geom_point()
```

```{r}
ggplot(data = df_train ,aes(y = fuel_type,x = price)) + geom_boxplot()
```


```{r}
ggplot(data = df_train %>% filter(price < 10^6),aes(y = int_col,x = price)) + geom_boxplot()
```


```{r}
ggplot(data = df_train %>% filter(price < 10^6),aes(y = accident,x = price)) + geom_boxplot()
```


```{r}
ggplot(data = df_train %>% filter(price < 10^6),aes(y = transmission,x = price)) + geom_boxplot()
```


```{r}
ggplot(data = df_train,aes(y = ext_col,x = price)) + geom_boxplot()
```


```{r}
ggplot(data = df_train,aes(y = ext_col,x = price)) + geom_boxplot()
```



```{r}
ggplot(data = df_train,aes(y = brand,x = price)) + geom_boxplot()
```

```{r}
engine_specs <- str_split(df_train$engine," ") %>% unlist() %>% as.data.frame()

```

```{r}
engine_specs <- strsplit(df_train$engine, " ")

max_length <- max(sapply(engine_specs, length))


split_df <- as.data.frame(matrix(NA, nrow = nrow(df_train), ncol = max_length))


colnames(split_df) <- paste0("Engine_spec", 1:max_length)

for (i in 1:nrow(df_train)) {
  split_df[i, 1:length(engine_specs[[i]])] <- engine_specs[[i]]
}
```


```{r}
# Combine the new columns with the original dataframe
df_train <- bind_cols(df_train, split_df)
```


```{r}
df_train <- df_train %>% mutate(premiumness = case_when(price > 10^6 ~ "Luxurious",
                                                        price < 10^6 & price >250000 ~ "Premium",
                                                        price > 80000 & price <= 250000 ~ "Mid range",
                                                        
                                                        price <= 80000 ~ "General"))
```


```{r}
ggplot(data = df_train,aes(y = price,x = premiumness)) + geom_boxplot()
```

